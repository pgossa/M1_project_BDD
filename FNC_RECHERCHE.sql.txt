CREATE OR REPLACE FUNCTION fnc_recherche_poids (mot_recherche varchar ,colonne varchar array, colonne_id_film int) 
RETURNS REAL AS
$f$

DECLARE

	INDICE INT;
	i      INT;
	WEIGHT REAL = 0;
	array_weight real array;
	array_synopsis  varchar array;
	
BEGIN
	INDICE = 1;
	i = 1;
	array_synopsis = array_cat(array_synopsis, (SELECT synopsis FROM vector WHERE id_film = $3));

	WHILE (i != array_length(array_synopsis, 1)) LOOP
	
		IF ($1 = array_synopsis[INDICE]) THEN
		i = array_length(array_synopsis, 1);
		ELSE
		INDICE = INDICE + 1 ;
		i = i+ 1;
		END IF;
	END LOOP;
	array_weight = array_cat(array_weight,(SELECT word_weight FROM vector WHERE id_film=$3));

	WEIGHT := array_weight[INDICE];

	

	RETURN WEIGHT;
                
END;
$f$
LANGUAGE plpgsql;